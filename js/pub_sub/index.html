<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>订阅发布者模式</title>
</head>
<style>
html,body{
    height: 100%;
}
</style>
<body>
    <script>
        // listener 1.收听者 es   callback(回调函数)   
        //2.发布者  document.body
        // 注册事件，鼠标点击的时候  就做  事件回调函数执行


    // document.body.addEventListener('click',function(){
    //     alert('111');
    // },false);
    // document.body.addEventListener('click',function(){
    //     alert('222');
    // },false);
    // document.body.addEventListener('click',function(){
    //     alert('333');
    // },false);
    let yq = {
        yz:99,
        name:'叶清'
         };  //发布者
    yq.peoplelist = [];   //存储订阅者的地方（数组）
    yq.listen = function(fn){
        this.peoplelist.push(fn);
    }
    yq.trigger = function(){
        for (var i = 0,fn; fn = this.peoplelist[i++];){
            fn.call(this,'今晚有空，可以去看电影');
        }
    }
    yq.listen(function(msg){
        console.log(`想听${this.name}${msg}唱歌`);
    })
    yq.listen(function(msg){
        console.log(`想看${this.name}${msg}跳舞`);
    })
    yq.listen(function(msg){
        console.log(`想看${this.name}${msg}女装`);
    })
    console.log(yq.peoplelist.length);

    // 先形成他们之间的订阅关系 订阅者？还没出现。（根据发布者的消息做出相应的反应）
    setTimeout (() => {
        yq.trigger();
    },3000);

    </script>
</body>
</html>